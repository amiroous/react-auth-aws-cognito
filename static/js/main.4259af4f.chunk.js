(this["webpackJsonpreact-auth-aws-cognito"]=this["webpackJsonpreact-auth-aws-cognito"]||[]).push([[0],{44:function(e,t,a){e.exports=a(61)},49:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(23),s=a.n(c),l=a(17),o=(a(49),a(16)),u=a(28),i=a(43),m=a(7),d=a(24),f=a(5),p=a.n(f),b=a(32),v=a(9),E=a(19),g=new E.c({UserPoolId:"us-west-2_EVTO798p8",ClientId:"3nuc8im44pumc9mos776091f4j"}),h=Object(n.createContext)(),w=function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var a=g.getCurrentUser();if(!a)return t();a.getSession(function(){var n=Object(v.a)(p.a.mark((function n(r,c){var s;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r){n.next=2;break}return n.abrupt("return",t(r));case 2:return n.next=4,N(a);case 4:s=n.sent,e(Object(b.a)({user:a},c,{},s));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,a){t.getUserAttributes((function(t,n){if(t)return a(t);n=n.reduce((function(e,t){var a=t.Name,n=t.Value;return Object(b.a)({},e,Object(d.a)({},a,n))}),{}),e(n)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0],s=a[1];Object(n.useEffect)((function(){Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w();case 3:s(!0),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))()}),[]);var l=function(){var e=Object(v.a)(p.a.mark((function e(t,a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var r=new E.b({Username:t,Pool:g}),c=new E.a({Username:t,Password:a});r.authenticateUser(c,{onSuccess:function(t){console.log("signInSuccess:",t),s(!0),e(t)},onFailure:function(e){console.error("signInError:",e),n(e)},newPasswordRequired:function(t){console.log("newPasswordRequired:",t),e(t)}})}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(h.Provider,{value:{authenticate:l,signOut:function(){var e=g.getCurrentUser();e&&(e.signOut(),s(!1))},authenticated:c,getSession:w}},e.children)},O=function(e){var t=e.children;return Object(n.useContext)(h).authenticated?t:null},j=function(){return r.a.createElement(u.a,{bg:"gradient-info",variant:"dark",expand:"md"},r.a.createElement(l.b,{className:"navbar-brand",to:"/"},"React Authentication"),r.a.createElement(u.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(u.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(i.a,{className:"mr-auto"},r.a.createElement(l.b,{className:"nav-link",to:"/"},"Home"),r.a.createElement(O,null,r.a.createElement(l.b,{className:"nav-link",to:"/secret"},"Secret")),r.a.createElement(l.b,{className:"nav-link",to:"/account"},"My Account"))))},y=function(e){var t=e.children;return r.a.createElement(n.Fragment,null,r.a.createElement(j,null),t)},S=function(e){var t=e.title,a=e.subTitle,n=void 0===a?null:a;return r.a.createElement("h1",{className:"text-info display-4 my-3"},t," ",r.a.createElement("small",{className:"text-muted font-weight-light"},n))},C=function(){var e=Object(n.useContext)(h),t=e.signOut;return e.authenticated?r.a.createElement("div",{className:"alert alert-info border-info d-flex justify-content-between align-items-center",role:"alert"},r.a.createElement("div",null,"You Are Logged In Successfully"),r.a.createElement("button",{onClick:t,type:"button",className:"btn btn-secondary"},"Logout")):r.a.createElement("div",{className:"alert alert-warning border-warning d-flex justify-content-between align-items-center",role:"alert"},r.a.createElement("div",null,"Please Login Bellow"))},P=function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),l=Object(m.a)(s,2),o=l[0],u=l[1];return r.a.createElement(n.Fragment,null,r.a.createElement("h3",{className:"text-uppercase"},"Sign Up"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g.signUp(a,o,[],null,(function(e,t){if(e)return console.error("signUpError: ",e);console.log("signUpSuccess: ",t)}))}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email address"),r.a.createElement("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",value:a,placeholder:"Enter email",onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"password",value:o,placeholder:"Password",onChange:function(e){return u(e.target.value)}})),r.a.createElement("button",{type:"submit",className:"btn btn-secondary"},"Sign Up")))},k=function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),l=Object(m.a)(s,2),o=l[0],u=l[1],i=Object(n.useContext)(h).authenticate,d=function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,i(a,o);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(n.Fragment,null,r.a.createElement("h4",{className:"text-uppercase"},"Sign In"),r.a.createElement("form",{onSubmit:d},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email address"),r.a.createElement("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",value:a,placeholder:"Enter email",onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"password",value:o,placeholder:"Password",onChange:function(e){return u(e.target.value)}})),r.a.createElement("button",{type:"submit",className:"btn btn-info"},"Sign In")))},F=function(){return Object(n.useContext)(h).authenticated?null:r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement(P,null)),r.a.createElement("div",{className:"col"},r.a.createElement(k,null)))},U=function(){return r.a.createElement(y,null,r.a.createElement("div",{className:"container page-home text-center"},r.a.createElement(S,{title:"React Authentication",subTitle:"Using AWS Cognito"}),r.a.createElement(C,null),r.a.createElement(F,null)))},H=function(){return r.a.createElement(y,null,r.a.createElement("div",{className:"container page-home text-center"},r.a.createElement(S,{title:"Secret Page",subTitle:"Need Authentication"})))},T=a(13),L=function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),l=Object(m.a)(s,2),o=l[0],u=l[1],i=Object(n.useContext)(h),d=i.authenticated,f=i.getSession,b=i.authenticate,E=Object(n.useRef)();if(!d)return null;var g=function(){var e=Object(v.a)(p.a.mark((function e(t){var n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return n=e.sent,r=n.user,c=n.email,e.prev=5,e.next=8,b(c,a);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(5),E.current.innerHTML='<div class="alert alert-danger mt-3">User is Not Authorized! Wrong Current Password</div>',e.abrupt("return");case 14:r.changePassword(a,o,(function(e,t){E.current.innerHTML=e?'<div class="alert alert-danger mt-3">'.concat(e.name,"</div>"):'<div class="alert alert-success mt-3">'.concat(t,"</div>")}));case 15:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,g();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(T.a,{bg:"gradient-info",text:"light",className:"col-6 mx-auto mt-5"},r.a.createElement(T.a.Header,{className:"bg-transparent"},r.a.createElement("h3",{className:"text-uppercase"},"Change Password")),r.a.createElement(T.a.Body,null,r.a.createElement("form",{onSubmit:w},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Current Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"password",value:a,placeholder:"Current Password",onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"newPassword"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"newPassword",value:o,placeholder:"New Password",onChange:function(e){return u(e.target.value)}})),r.a.createElement("button",{type:"submit",className:"btn btn-secondary"},"Confirm")),r.a.createElement("div",{className:"message",ref:E})))},I=function(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),l=Object(m.a)(s,2),o=l[0],u=l[1],i=Object(n.useState)(""),d=Object(m.a)(i,2),f=d[0],b=d[1],w=Object(n.useState)(""),N=Object(m.a)(w,2),x=N[0],O=N[1],j=Object(n.useState)(1),y=Object(m.a)(j,2),S=y[0],C=y[1],P=Object(n.useContext)(h),k=P.authenticated,F=P.getSession,U=Object(n.useRef)(),H=Object(n.useRef)(),L=Object(n.useRef)();if(k)return null;var I=function(){return new E.b({Username:a.toLowerCase(),Pool:g})};F().then((function(e){var t=e.email;return c(t)})).catch((function(e){}));var A=function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),I().forgotPassword({onSuccess:function(e){console.log("onSuccess",e)},onFailure:function(e){console.log("onFailure",e)},inputVerificationCode:function(e){console.log("inputVerificationCode",e),U.current.innerHTML='\n                    <div class="alert alert-success mt-3">\n                        If There is any record in our system, an email will be sent to:\n                        <br/>\n                        <b>'.concat(e.CodeDeliveryDetails.Destination,"</b>\n                        </div>\n                "),H.current.classList.add("d-none"),setTimeout((function(){return C(2)}),3e3)}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),f===x){e.next=4;break}return U.current.innerHTML='\n                <div class="alert alert-success mt-3">\n                    Entered Password Should be Identical with Confirmed Password! \n                </div>\n            ',e.abrupt("return");case 4:I().confirmPassword(o,f,{onSuccess:function(e){U.current.innerHTML='\n                <div class="alert alert-success mt-3">Your Password Has Successfully Updated</div>\n                '},onFailure:function(e){U.current.innerHTML='\n                <div class="alert alert-danger mt-3">'.concat(e.message,"</div>\n            ")}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(T.a,{bg:"gradient-info",text:"light",className:"col-6 mx-auto mt-5"},1===S&&r.a.createElement(n.Fragment,null,r.a.createElement(T.a.Header,{className:"bg-transparent"},r.a.createElement("h3",{className:"text-uppercase"},"Send Verification Code")),r.a.createElement(T.a.Body,null,r.a.createElement("form",{ref:H,onSubmit:A},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email address"),r.a.createElement("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp",defaultValue:a,placeholder:"Enter email",onChange:function(e){return c(e.target.value)}})),r.a.createElement("button",{type:"submit",className:"btn btn-secondary"},"Send Verification Code")),r.a.createElement("div",{className:"message",ref:U}))),2===S&&r.a.createElement(n.Fragment,null,r.a.createElement(T.a.Header,{className:"bg-transparent"},r.a.createElement("h3",{className:"text-uppercase"},"Change Password")),r.a.createElement(T.a.Body,null,r.a.createElement("form",{ref:L,onSubmit:D},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",id:"code","aria-describedby":"codeHelp",placeholder:"Enter Verification Code",value:o,onChange:function(e){return u(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control",id:"password",placeholder:"Enter Password",value:f,onChange:function(e){return b(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control",id:"confirmPassword",placeholder:"Confirm Password",value:x,onChange:function(e){return O(e.target.value)}})),r.a.createElement("button",{type:"submit",className:"btn btn-secondary"},"Change Password")),r.a.createElement("div",{className:"message",ref:U}))))},A=function(){return r.a.createElement(y,null,r.a.createElement("div",{className:"container page-home text-center"},r.a.createElement(S,{title:"Account Page"}),r.a.createElement(L,null),r.a.createElement(I,null)))},D=function(){return r.a.createElement("div",{className:"app"},r.a.createElement(o.a,{exact:!0,path:"/",component:U}),r.a.createElement(O,null,r.a.createElement(o.a,{exact:!0,path:"/secret",component:H})),r.a.createElement(o.a,{exact:!0,path:"/account",component:A}))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.a,{basename:"/react-auth-aws-cognito"},r.a.createElement(x,null,r.a.createElement(D,null)))),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.4259af4f.chunk.js.map